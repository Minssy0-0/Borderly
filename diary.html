<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Trip Diary - Borderly</title>
    <link rel="stylesheet" href="shared.css">
    <link rel="stylesheet" href="diary.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header>
  <nav>
    <div class="navbar">
        <div class="cover-up"></div>
  
<div class="nav-left">
    <button id="cloudToggle" class="cloud-nav" aria-label="Open navigation">☁️</button>
    <navmenu>
    <a href="javascript:openDocumentsModal()">Documents</a>
    <a href="javascript:openLuggageModal()">Luggage</a>
    <a href="javascript:openVaccinesModal()">Vaccines</a>
    <a href="javascript:openVisasModal()">Visas</a>
    <a href="checker.html">Travel Insurance</a>

    <div id="cloudAuthArea"></div> 
</navmenu>
    <div id="navAuthSection" class="nav-auth-group">
        <a href="javascript:void(0)" onclick="gatekeeper('profile.html')" class="nav-icon-link" title="Profile">
            <div class="profile-circle">
                <img src="Stock/defaultPic.webp" id="navAvatar" alt="User" class="nav-avatar">
            </div>
        </a>

        <button id="authBtn" class="nav-auth-btn"></button>
    </div>
</div>
    <navmenu class="navmenu" id="cloudMenu">
        <a href="javascript:openDocumentsModal()">Documents</a>
        <a href="javascript:openLuggageModal()">Luggage</a>
        <a href="javascript:openVaccinesModal()">Vaccines</a>
        <a href="javascript:openVisasModal()">Visas</a>
        <a href="checker.html">Travel Insurance</a>
    </navmenu>
</div>
      <div class="logo">
        <a href="index.html"><img src="Stock/logo sample (2).png" alt="Borderly Logo"></a>
      </div>
<div class="nav-right" style="display: flex; gap: 20px; align-items: center; padding-right: 20px;">
    
<div id="dynamicDiaryWrapper" class="diary-wrapper" style="display: flex;">
    </div>
</div>
    </div>
  </nav>
    </header>

    <main>
        <section id="diary-container">
        <header class="diary-header">
        </header>

        <section id="emptyDiary" class="diary-empty-state">
            <h1>My Travel Diary</h1>
            <p>Your curated collection of travel gems and tips.</p>
            <div class="empty-illustration">
                <i class="fa-solid fa-map-location-dot"></i>
            </div>
            <h2>Your diary is waiting...</h2>
            <p>You haven't saved any travel gems yet. Explore the feed to find places you'd love to visit!</p>
            <a href="community.html" class="explore-btn">Explore Feed</a>
        </section>

        <section id="filledDiary" class="diary-filled-state" style="display: none;">
            <div class="filled-header">
                <h1>My Travel Diary</h1>
                <p>Your curated collection of travel gems and tips.</p>
            </div>
            <div class="recent-badge">LATEST MEMORIES</div>
            <div id="fullPostsPreview" class="full-posts-preview-row">
                </div>
        </section>

     <div class="folders-management-section">
    <div class="folder-header-container">
        <h3 class="section-label">My Collections</h3>
        <button class="create-folder-btn" onclick="openNewFolderPrompt()">
            <i class="fa-solid fa-plus"></i> New Folder
        </button>
    </div>

    <div id="foldersGrid" class="folders-grid">
        <div class="folder-card">
            <button class="delete-folder-btn" title="Delete Folder">×</button>
            <div class="folder-icon">
                <i class="fa-solid fa-folder"></i>
            </div>
            <h4>General</h4>
            <span class="post-count">0 POSTS</span>
        </div>
        
        </div>
</div>

<div id="folderContentArea" class="folder-content-area" style="display: none;">
    <div class="content-header">
        <h2 id="activeFolderName">Folder Name</h2>
        <button onclick="closeFolderView()" class="close-view-btn">×</button>
    </div>
    
    <div id="diaryPostsGrid" class="community-grid"> 
        </div>
</div>


        
<script>
document.addEventListener('DOMContentLoaded', () => {
    // Load saved diary items from localStorage
    function loadSavedDiary() {
        return JSON.parse(localStorage.getItem('diary_items')) || [];
    }

    const savedItems = loadSavedDiary();
    const diaryGrid = document.getElementById('diaryGrid');
    const emptyDiary = document.getElementById('emptyDiary');
    const modal = document.getElementById('destinationModal');
    const closeModal = document.getElementById('closeModal');
    let currentImageIndex = 0;
    let currentDestination = null;

    // Clear existing placeholder cards
    diaryGrid.innerHTML = '';

    if (savedItems.length === 0) {
        // Show empty state
        emptyDiary.style.display = 'block';
    } else {
        // Hide empty state
        emptyDiary.style.display = 'none';

        // Create cards for each saved item
        savedItems.forEach((item, itemIndex) => {
            const card = document.createElement('div');
            card.className = 'diary-card clickable-card';
            
            card.innerHTML = `
                <div class="card-img-wrapper">
                    <img src="${item.image}" alt="${item.title}">
                    <button class="remove-btn" title="Remove from diary">&times;</button>
                </div>
                <div class="card-content">
                    <span class="tag">${item.country}</span>
                    <h3>${item.title}</h3>
                    <p>Saved on ${new Date(item.timestamp).toLocaleDateString()}</p>
                </div>
            `;

            // Add click handler to open modal
            card.addEventListener('click', (e) => {
                if (e.target.classList.contains('remove-btn')) return;
                openModal(item.title);
            });

            diaryGrid.appendChild(card);
        });

        // Add remove functionality
        const removeButtons = document.querySelectorAll('.remove-btn');
        removeButtons.forEach((btn, index) => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                savedItems.splice(index, 1);
                localStorage.setItem('diary_items', JSON.stringify(savedItems));
                location.reload();
            });
        });
    }

    // Modal Functions
    function openModal(destinationTitle) {
        currentDestination = destinationTitle;
        currentImageIndex = 0;

        const details = destinationDetails[destinationTitle] || {
            images: ['https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?auto=format&fit=crop&w=600'],
            description: 'Explore this amazing destination.',
            reviews: [{ name: 'Traveler', rating: 5, text: 'Amazing place!' }]
        };

        document.getElementById('modalTitle').textContent = destinationTitle;
        document.getElementById('modalDescription').textContent = details.description;
        document.getElementById('carouselImage').src = details.images[0];
        document.getElementById('imageCounter').textContent = `1/${details.images.length}`;

        // Display reviews
        const reviewsContainer = document.getElementById('reviewsContainer');
        reviewsContainer.innerHTML = '';
        details.reviews.forEach(review => {
            const reviewEl = document.createElement('div');
            reviewEl.className = 'review-item';
            reviewEl.innerHTML = `
                <div class="review-header">
                    <p class="review-name">${review.name}</p>
                    <div class="review-rating">
                        <span class="stars">${'★'.repeat(review.rating)}${'☆'.repeat(5 - review.rating)}</span>
                    </div>
                </div>
                <p class="review-text">${review.text}</p>
            `;
            reviewsContainer.appendChild(reviewEl);
        });

        modal.style.display = 'block';
    }

    function closeModalFunc() {
        modal.style.display = 'none';
        currentImageIndex = 0;
    }

    function updateCarousel() {
        const details = destinationDetails[currentDestination];
        if (!details) return;

        document.getElementById('carouselImage').src = details.images[currentImageIndex];
        document.getElementById('imageCounter').textContent = `${currentImageIndex + 1}/${details.images.length}`;
    }

    // Modal event listeners
    closeModal.addEventListener('click', closeModalFunc);

    window.addEventListener('click', (e) => {
        if (e.target === modal) {
            closeModalFunc();
        }
    });

    document.getElementById('prevBtn').addEventListener('click', () => {
        const details = destinationDetails[currentDestination];
        currentImageIndex = (currentImageIndex - 1 + details.images.length) % details.images.length;
        updateCarousel();
    });

    document.getElementById('nextBtn').addEventListener('click', () => {
        const details = destinationDetails[currentDestination];
        currentImageIndex = (currentImageIndex + 1) % details.images.length;
        updateCarousel();
    });

    // Update Member dropdown
    function updateMemberDropdown() {
        const diaryDropdown = document.querySelector('.pathway-member .diary-dropdown');
        
        if (diaryDropdown) {
            if (savedItems.length === 0) {
                diaryDropdown.innerHTML = `
                    <div style="font-weight: 800; font-size: 0.7rem; color: #94a3b8; margin-bottom: 10px;">YOUR SAVES</div>
                    <p style="font-size: 0.8rem; color: #64748b;">Your diary is empty.</p>
                    <hr style="border: 0; border-top: 1px solid #f1f5f9; margin: 10px 0;">
                    <a href="diary.html" style="display: block; text-align: center; color: #466bc3; font-weight: 700; text-decoration: none; font-size: 0.75rem;">Open Diary</a>
                `;
            } else {
                let itemsHTML = `<div style="font-weight: 800; font-size: 0.7rem; color: #94a3b8; margin-bottom: 10px;">YOUR SAVES (${savedItems.length})</div>`;
                
                savedItems.forEach(item => {
                    itemsHTML += `
                        <div style="display: flex; align-items: center; gap: 8px; padding: 8px; background: #f8fafc; border-radius: 8px; margin-bottom: 8px;">
                            <img src="${item.image}" alt="${item.title}" style="width: 40px; height: 40px; border-radius: 6px; object-fit: cover;">
                            <div style="flex: 1;">
                                <p style="font-size: 0.7rem; font-weight: 700; color: #334155; margin: 0;">${item.title}</p>
                                <p style="font-size: 0.65rem; color: #94a3b8; margin: 2px 0 0 0;">${item.country}</p>
                            </div>
                        </div>
                    `;
                });
                
                itemsHTML += `<hr style="border: 0; border-top: 1px solid #f1f5f9; margin: 10px 0;">`;
                itemsHTML += `<a href="diary.html" style="display: block; text-align: center; color: #466bc3; font-weight: 700; text-decoration: none; font-size: 0.75rem;">Open Diary</a>`;
                
                diaryDropdown.innerHTML = itemsHTML;
            }
        }
    }

    updateMemberDropdown();
});
</script>
    <script src="database.js"></script>
    <script src="auth.js"></script>
    <script src="search.js"></script>
    <script src="cloude.js"></script>
    <script src="pathways.js"></script>
    <script src="posts.js"></script>
</body>
</html>